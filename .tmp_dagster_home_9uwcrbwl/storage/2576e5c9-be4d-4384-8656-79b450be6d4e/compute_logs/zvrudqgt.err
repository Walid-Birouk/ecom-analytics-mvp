[32m2026-02-05 17:16:38 +0100[0m - dagster - [34mDEBUG[0m - daily_ecom_pipeline - 2576e5c9-be4d-4384-8656-79b450be6d4e - 16524 - LOGS_CAPTURED - Started capturing logs in process (pid: 16524).
[32m2026-02-05 17:16:38 +0100[0m - dagster - [34mDEBUG[0m - daily_ecom_pipeline - 2576e5c9-be4d-4384-8656-79b450be6d4e - 16524 - dbt_build - STEP_START - Started execution of step "dbt_build".
[32m2026-02-05 17:16:43 +0100[0m - dagster - [34mWARNING[0m - daily_ecom_pipeline - 2576e5c9-be4d-4384-8656-79b450be6d4e - dbt_build - An error was encountered when creating a handle to the dbt adapter in Dagster.
Traceback (most recent call last):
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\resource.py", line 700, in cli
    adapter = self._initialize_dbt_core_adapter(args)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\resource.py", line 381, in _initialize_dbt_core_adapter
    profile = load_profile(self.project_dir, cli_vars, self.profile, self.target)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dbt\config\runtime.py", line 79, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dbt\config\profile.py", line 404, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dbt\config\profile.py", line 361, in from_raw_profiles
    raise DbtProjectError("Could not find profile named '{}'".format(profile_name))
dbt.exceptions.DbtProjectError: Runtime Error
  Could not find profile named 'ecom_dbt'
[32m2026-02-05 17:16:44 +0100[0m - dagster - [34mINFO[0m - daily_ecom_pipeline - 2576e5c9-be4d-4384-8656-79b450be6d4e - dbt_build - Copying `C:\Users\Walid\Documents\ecom-analytics-mvp\dbt\ecom_dbt\target\partial_parse.msgpack` to `C:\Users\Walid\Documents\ecom-analytics-mvp\dbt\ecom_dbt\target\37a3a83\partial_parse.msgpack` to take advantage of partial parsing.
[32m2026-02-05 17:16:44 +0100[0m - dagster - [34mINFO[0m - daily_ecom_pipeline - 2576e5c9-be4d-4384-8656-79b450be6d4e - dbt_build - Running dbt command: `dbt build`.
Exception ignored in: <generator object DbtCliInvocation._stream_stdout at 0x0000016755DD7E40>
Traceback (most recent call last):
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\dbt_cli_invocation.py", line 378, in stream_raw_events
    yield event
RuntimeError: generator ignored GeneratorExit
[32m2026-02-05 17:16:49 +0100[0m - dagster - [34mERROR[0m - [31mdaily_ecom_pipeline - 2576e5c9-be4d-4384-8656-79b450be6d4e - 16524 - dbt_build - STEP_FAILURE - Execution of step "dbt_build" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "dbt_build"::

KeyError: 'nodes'

Stack Trace:
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster\_core\execution\plan\utils.py", line 57, in op_execution_error_boundary
    yield
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster\_utils\__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "C:\Users\Walid\Documents\ecom-analytics-mvp\orchestration\defs.py", line 65, in dbt_build
    for event in dbt.cli(["build"]).stream():
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\dbt_event_iterator.py", line 215, in __next__
    return next(self._inner_iterator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\dbt_cli_invocation.py", line 289, in _stream_asset_events
    yield from event.to_default_asset_events(
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\dbt_cli_event.py", line 571, in to_default_asset_events
    if self._is_model_execution_event(manifest):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\dbt_cli_event.py", line 260, in _is_model_execution_event
    resource_props = self._get_resource_props(self._unique_id, manifest)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Walid\anaconda3\envs\ecom-pipeline\Lib\site-packages\dagster_dbt\core\dbt_cli_event.py", line 280, in _get_resource_props
    return manifest["nodes"][unique_id]
           ~~~~~~~~^^^^^^^^^
[0m
